<div id="numbers-list-demo">
  <p id="status">number drag and drop status...</p>
  <div id="numbers-list"></div>
  <button id="control-button">click on me</button>
</div>
<script>
(() => {
  const component = document.getElementById('numbers-list-demo');
  const status = document.getElementById('status');
  const numbersList = document.getElementById('numbers-list');
  const controlButton = document.getElementById('control-button');

  let counter = 1;
  const numbers = Array.from({length:5},()=>Math.floor(Math.random()*1000)+1);
  let paragraphThatIsDragging = null;

  // Render numbers
  numbers.forEach((num, idx)=>{
    const p = document.createElement('p');
    p.id = `p${idx+1}`;
    p.classList.add('number');
    if ((idx+1)%2===1) p.classList.add('odd'); else p.classList.add('even');
    p.dataset.number = num;
    p.textContent = `this is ${num}`;
    p.draggable = true;
    p.addEventListener('dragstart', (e)=>{
      paragraphThatIsDragging = e.target;
      status.textContent = `dragging number ${num}`;
      paragraphThatIsDragging.classList.add('dragging');
      e.dataTransfer.setData('text/plain', idx);
    });
    p.addEventListener('dragover', (e)=>{
      e.preventDefault();
      const target = e.target.closest('p');
      if (!target || !paragraphThatIsDragging || target === paragraphThatIsDragging) return;
      const parent = target.parentNode;
      const placeholder = document.createElement('span');
      parent.insertBefore(placeholder, paragraphThatIsDragging);
      parent.insertBefore(paragraphThatIsDragging, target);
      parent.insertBefore(target, placeholder);
      parent.removeChild(placeholder);
    });
    p.addEventListener('dragend', (e)=>{
      status.textContent = `dropped number ${num}`;
      if (paragraphThatIsDragging) {
        paragraphThatIsDragging.classList.remove('dragging');
      }
      paragraphThatIsDragging = null;
    });
    p.addEventListener('mouseenter', ()=>{
      p.classList.add('hover');
    });
    p.addEventListener('mouseleave', ()=>{
      p.classList.remove('hover');
    });
    numbersList.appendChild(p);
  });

  component.addEventListener('click', (e)=>{
    component.classList.add('click_inside');
    e.stopPropagation();
  });

  document.addEventListener('click', (e)=>{
    if (!component.contains(e.target)) {
      component.classList.remove('click_inside');
    }
  });

  controlButton.classList.add('control-button');
  controlButton.addEventListener('mousedown', ()=>{
    controlButton.classList.add('click');
    alert(`you click on me ${counter} times`);
    counter += 2;
  });
  controlButton.addEventListener('mouseup', ()=>{
    controlButton.classList.remove('click');
  });
})();
</script>

