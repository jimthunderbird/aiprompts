<div id="numbers-list-demo">
  <p id="status">number drag and drop status...</p>
  <div id="numbers-list"></div>
  <button id="control-button">click on me</button>
</div>

<script>
  // Component data
  let counter = 1;
  let numbers = [];
  let paragraph_that_is_dragging = null;

  // Generate 5 random numbers between 1 and 1000
  for (let i = 0; i < 5; i++) {
    numbers.push(Math.floor(Math.random() * 1000) + 1);
  }

  const demo = document.getElementById('numbers-list-demo');
  const status = document.getElementById('status');
  const numbersList = document.getElementById('numbers-list');
  const controlButton = document.getElementById('control-button');

  // Create number paragraphs
  numbers.forEach((num, index) => {
    const p = document.createElement('p');
    p.className = 'number';
    p.id = `p${index + 1}`;
    p.textContent = `this is ${num}`;
    if (num % 2 === 0) {
      p.classList.add('even');
    } else {
      p.classList.add('odd');
    }

    // Drag events
    p.setAttribute('draggable', true);

    p.addEventListener('dragstart', function () {
      status.textContent = `dragging number ${num}`;
      this.classList.add('dragging');
      paragraph_that_is_dragging = this;
    });

    p.addEventListener('dragover', function (e) {
      e.preventDefault();
      if (paragraph_that_is_dragging !== this) {
        const temp = paragraph_that_is_dragging.innerHTML;
        paragraph_that_is_dragging.innerHTML = this.innerHTML;
        this.innerHTML = temp;

        // Update IDs after swap
        const tempId = paragraph_that_is_dragging.id;
        paragraph_that_is_dragging.id = this.id;
        this.id = tempId;

        // Update numbers array after swap
        const idx1 = numbers.findIndex(n => n === parseInt(paragraph_that_is_dragging.textContent.split(' ')[2]));
        const idx2 = numbers.findIndex(n => n === parseInt(this.textContent.split(' ')[2]));
        [numbers[idx1], numbers[idx2]] = [numbers[idx2], numbers[idx1]];

        paragraph_that_is_dragging = this;
      }
    });

    p.addEventListener('dragend', function () {
      status.textContent = `dropped number ${num}`;
      this.classList.remove('dragging');
    });

    p.addEventListener('mouseenter', function () {
      this.classList.add('hover');
    });

    p.addEventListener('mouseleave', function () {
      this.classList.remove('hover');
    });

    numbersList.appendChild(p);
  });

  // Click inside/outside of component
  demo.addEventListener('click', function (e) {
    if (this.contains(e.target)) {
      this.classList.add('click_inside');
    } else {
      this.classList.remove('click_inside');
    }
  });

  // Control button logic
  controlButton.addEventListener('mousedown', function () {
    this.classList.add('click');
    alert(`you click on me ${counter} times`);
    counter += 2;
  });

  controlButton.addEventListener('mouseup', function () {
    this.classList.remove('click');
  });
</script>

