<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>HTML Component Demo</title>
</head>
<body>
  <div id="numbers-list-demo">
    <p id="status">number drag and drop status...</p>
    <div id="numbers-list"></div>
    <button id="control-button" class="">click on me</button>
  </div>
  
  <script>
    let counter = 1; // local variable for the component
    
    window.onload = function() {
      const numbers = Array.from({length: 5}, () => Math.floor(Math.random() * 1000) + 1));
      
      document.getElementById('numbers-list').innerHTML = '';

      for (let i = 0; i < numbers.length; i++) {
        let p = document.createElement("p");
        p.className += "number";
        
        if ((i + 1) % 2 === 0) {
          p.className += ' even';
        } else {
          p.className += ' odd';
        }
        
        p.id = 'p' + (i + 1);
        p.innerHTML = "this is " + numbers[i];
        document.getElementById('numbers-list').appendChild(p);
      }
    };
    
    document.getElementById("control-button").onmousedown = function() {
      this.className += ' click';
      alert("you click on me " + counter + " times");
      counter += 2;
    };

    document.getElementById("control-button").onmouseup = function() {
      this.className = this.className.replace(/(?:^|\s)click(?!\S)/g, '');
    }
    
    let draggingParagraph = null;
    document.getElementById('numbers-list').addEventListener("dragstart", function (e) {
      const p = e.target;
      
      if (!p.className.includes("number")) return;  // Ignore non-number paragraphs
      
      draggingParagraph = p;
      document.getElementById('status').innerText = "dragging number " + p.innerText.split(" ")[2];
      p.className += ' dragging';
    });
    
    document.getElementById('numbers-list').addEventListener("dragover", function (e) {
      e.preventDefault();  // Necessary to allow dropping
      
      const p = e.target;
      
      if (!p.className.includes("number")) return;  // Ignore non-number paragraphs
        
      let draggingText = document.getElementById('status').innerText.split(" ");
      draggingText[1] = "and";
      document.getElementById('status').innerText = draggingText.join(" ");
      
      p.className = p.className.replace(/(?:^|\s)dragging(?!\S)/g, '');  // Remove old dragging class
      draggingParagraph.innerHTML = p.innerHTML;
      p.innerHTML = draggingParagraph.innerHTML;
      
      draggingParagraph.className += " dragging";
    });
    
    document.getElementById('numbers-list').addEventListener("dragend", function (e) {
      const p = e.target;
      
      if (!p.className.includes("number")) return;  // Ignore non<｜begin▁of▁sentence｜>umber paragraphs
      
      draggingParagraph.className = draggingParagraph.className.replace(/(?:^|\s)dragging(?!\S)/g, '');
      document.getElementById('status').innerText = "dropped number " + p.innerText.split(" ")[2];
    });
    
    document.getElementById('numbers-list').addEventListener("mouseover", function (e) {
      const p = e.target;
      
      if (!p.className.includes("number")) return;  // Ignore non-number paragraphs
      
      p.className += ' hover';
    });
    
    document.getElementById('numbers-list').addEventListener("mouseout", function (e) {
      const p = e.target;
      
      if (!p.className.includes("number")) return;  // Ignore non-number paragraphs
      
      p.className = p.className.replace(/(?:^|\s)hover(?!\S)/g, '');
    });
  </script>
</body>
</html>
